<h2>注文情報確認</h2>

<table>
  <thead>
    <tr>
      <th>商品名</th>
      <th>単価</th>
      <th>数量</th>
      <th>小計</th>
    </tr>
  </thead>
  
  <% @cart_items.each do |cart| %> 
  <tbody>
    <tr>
      <%= cart.item.name %>
      <%= cart.item.with_tax_price.to_s(:delimited) %>
      <%= cart.amount %>
      <%= cart.subtotal.to_s(:delimited) %>
      <% end %>  
    </tr>
  </tbody>
</table>

<table>
  <% @cart_items.each do |cart| %>
   <% @total += cart.subtotal %>
   <% @total_payment = @total + @postage %>
  <% end %>
  <tbody>
    <tr>
      <th>送料</th>
      <td><%= @postage.to_s(:delimited%) %></td>
    </tr>
    <tr>
      <th>商品合計</th>
      <td><%= @total.to_s(:delimited%) %></td>
    </tr>
    <tr>
      <th>請求金額</th>
      <td><%= @total_payment.to_s(:delimited%) %></td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <th>支払方法</th>
      <td><%= @order.payment_method_i18n %></td>
    </tr>
    <tr>
      <th>お届け先</th>
      <td>〒<%= @order.post_code %><%= @order.address %><br>
       <%= @order.name %></td>
    </tr>
  </tbody>
</table>

<%= form_with model: @order, url: orders_path, method: :post do |f|  %>
 <%= f.hidden_field :post_code %>
 <%= f.hidden_field :address %>
 <%= f.hidden_field :name %>
 <%= f.hidden_field :postage %>
 <%= f.hidden_field :total_payment, :value => @total_payment %>
 <%= f.hidden_field :payment_method %>
 <%= f.hidden_field :status %>
 
 <%= f.submit "注文を確定する", class="btn btn-primary" %>
<% end %>
 


